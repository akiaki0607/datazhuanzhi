# Excel转置处理工具 - 部署说明

## 🌐 内网穿透部署方案

### 方案一：ngrok（推荐，最简单）

#### 1. 注册ngrok账号
- 访问：https://ngrok.com
- 注册免费账号
- 获取authtoken

#### 2. 配置ngrok
```bash
# 下载并安装ngrok
curl -L https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-darwin-amd64.zip -o ngrok.zip
unzip ngrok.zip
rm ngrok.zip

# 配置authtoken
./ngrok authtoken YOUR_AUTHTOKEN
```

#### 3. 启动服务
```bash
# 使用提供的脚本
./start_ngrok.sh

# 或手动启动
# 终端1：启动Flask应用
source venv/bin/activate
python app.py

# 终端2：启动ngrok
./ngrok http 8080
```

#### 4. 获取公网地址
ngrok会显示类似这样的地址：
```
https://abc123.ngrok.io -> http://localhost:8080
```

### 方案二：Cloudflare Tunnel（免费，稳定）

#### 1. 安装cloudflared
```bash
# macOS
brew install cloudflared

# 其他系统
# 参考：https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation/
```

#### 2. 登录Cloudflare
```bash
cloudflared tunnel login
```

#### 3. 启动服务
```bash
# 使用提供的脚本
./start_cloudflare.sh

# 或手动启动
# 终端1：启动Flask应用
source venv/bin/activate
python app.py

# 终端2：启动tunnel
cloudflared tunnel --url http://localhost:8080
```

### 方案三：frp（需要自己的服务器）

#### 1. 下载frp客户端
```bash
# 下载frp
wget https://github.com/fatedier/frp/releases/download/v0.52.3/frp_0.52.3_darwin_amd64.tar.gz
tar -xzf frp_0.52.3_darwin_amd64.tar.gz
cd frp_0.52.3_darwin_amd64
```

#### 2. 配置frpc.ini
使用项目根目录下的 `frpc.ini` 配置文件

#### 3. 启动服务
```bash
# 终端1：启动Flask应用
source venv/bin/activate
python app.py

# 终端2：启动frp客户端
./frpc -c frpc.ini
```

## 🚀 快速部署步骤

### 使用ngrok（推荐）

1. **注册ngrok账号**
   - 访问 https://ngrok.com
   - 注册免费账号
   - 获取authtoken

2. **配置ngrok**
   ```bash
   # 在项目目录下执行
   ./ngrok authtoken YOUR_AUTHTOKEN
   ```

3. **启动服务**
   ```bash
   # 一键启动
   ./start_ngrok.sh
   ```

4. **分享链接**
   - ngrok会显示公网地址
   - 例如：`https://abc123.ngrok.io`
   - 将这个地址分享给其他人

## 📱 访问方式

### 本地访问
- http://localhost:8080

### 公网访问
- 通过ngrok/cloudflare tunnel提供的地址
- 例如：https://abc123.ngrok.io

## 🔧 配置说明

### 端口配置
- 默认端口：8080
- 如需修改，编辑 `app.py` 中的端口号

### 防火墙设置
- 确保8080端口未被防火墙阻止
- 内网穿透工具会自动处理端口映射

## 📋 注意事项

1. **免费服务限制**
   - ngrok免费版：连接数限制，每次重启地址会变
   - cloudflare tunnel：免费，相对稳定

2. **安全性**
   - 公网访问时注意数据安全
   - 建议设置访问密码或IP白名单

3. **性能**
   - 内网穿透会有一定延迟
   - 建议在稳定网络环境下使用

## 🛠️ 故障排除

### 常见问题

1. **端口被占用**
   ```bash
   # 查看端口占用
   lsof -i :8080
   
   # 杀死占用进程
   kill -9 $(lsof -ti :8080)
   ```

2. **ngrok连接失败**
   - 检查网络连接
   - 确认authtoken正确
   - 尝试重启ngrok

3. **Flask应用启动失败**
   - 检查Python环境
   - 确认依赖包已安装
   - 查看错误日志

## 📞 技术支持

如有问题，请检查：
1. 网络连接是否正常
2. 端口是否被占用
3. 防火墙设置是否正确
4. 内网穿透工具是否正常运行
